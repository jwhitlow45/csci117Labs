// Append with difference lists
local L1 End1 L2 End2 H1 T1 H2 T2 LNew in
   L1 = ((1|(2|End1)) # End1)        // List [1,2] as a difference list
   L2 = ((3|(4|End2)) # End2)        // List [3,4] as a difference list
   
   L1 = (H1 # T1)                    // Pattern match, name head and tail
   L2 = (H2 # T2)                    // Pattern match, name head and tail
   T1 = H2                           // Bind/unify tail of L1 with head of L2

   LNew = (L1 # T2)                  // Build a new difference list
   
   // fun {Reverse Xs}
   //    proc {ReverseD Xs ?Y1 Y}
   //       case Xs of
   //       nil then 
   //          Y1=Y
   //       [] X|Xr then 
   //          {ReverseD Xr Y1 X|Y}
   //       end
   //    end Y1
   // in
   //    {ReverseD Xs Y1 nil} Y1
   // end

 local Reverse Out in 
   Reverse = fun {$ Xs}
      local ReverseD Y1 Y in                  
         ReverseD = proc {$ Xs Y1 Y}     
            case Xs of nil then 
               Y1 = Y
            [] '|'(1:X 2:Xr) then  
               local A Log in
                     Log = 999                 
                     A = '|'(1:X 2:Y)  
                     skip Browse Log    
                     {ReverseD Xr Y1 A}
               end        
            [] '#'(1:X 2:Xr) then 
               {ReverseD X Y1 Y}
            end

         end 
         {ReverseD Xs Y1 nil} Y1
      end
   end

      local Out LTest in
         LTest = (1|(2|(3|(4|(5|(6|nil))))))
         Out = {Reverse LTest}
         skip Browse LTest
         skip Browse Out
      end
   end 
   skip Full
end

/* 2c
   The number of cons operations in both 2a and 2b are both 6. I determined
      this by adding a local variable Log where cons was being called, setting
      binding Log to 999, and then running skip Browse Log right before cons
      is called. This allows for me to easily count the number of times that
      cons is called by counting the amount of times that skip Browse Log is
      called at the top of my output. It is unsurprising that these are
      both only called 6 times as while they may recur more than 6 times,
      cons is only called when the procedure contains an empty list.
*/
