[local ["O","Generate","TakeLazy","Times","Merge","Ham"] [Generate = proc {$ N EXU1} [EXU1 = proc {$ EXU2} [local ["EXU3","EXU4"] [EXU3 = N,local ["EXU5"] [local ["EXU6","EXU7"] [EXU6 = N,EXU7 = 1,"IntPlus" "EXU6" "EXU7" "EXU5"],"Generate" "EXU5" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]],Times = proc {$ N F EXU1} [EXU1 = proc {$ EXU2} [local ["A","As","PTU2"] [PTU2 = '#'(1:A 2:As),"F" "PTU2",local ["EXU3","EXU4"] [local ["EXU5","EXU6"] [EXU5 = N,EXU6 = A,"IntMultiply" "EXU5" "EXU6" "EXU3"],local ["EXU5","EXU6"] [EXU5 = N,EXU6 = As,"Times" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],Merge = proc {$ Xs Ys EXU1} [EXU1 = proc {$ EXU2} [local ["A","As","PTU2"] [PTU2 = '#'(1:A 2:As),"Xs" "PTU2",local ["B","Bs","PTU2"] [PTU2 = '#'(1:B 2:Bs),"Ys" "PTU2",local ["EXU3"] [local ["EXU4","EXU5"] [EXU4 = A,EXU5 = B,"LT" "EXU4" "EXU5" "EXU3"],if EXU3 then [local ["EXU4","EXU5"] [EXU4 = A,local ["EXU6","EXU7"] [EXU6 = As,EXU7 = Ys,"Merge" "EXU6" "EXU7" "EXU5"],EXU2 = '#'(1:EXU4 2:EXU5)]] else [local ["EXU4"] [local ["EXU5","EXU6"] [EXU5 = A,EXU6 = B,"Eq" "EXU5" "EXU6" "EXU4"],if EXU4 then [local ["EXU5","EXU6"] [EXU5 = A,local ["EXU7","EXU8"] [EXU7 = As,EXU8 = Bs,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]] else [local ["EXU5","EXU6"] [EXU5 = B,local ["EXU7","EXU8"] [EXU7 = Xs,EXU8 = Bs,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]]]]]]]]],TakeLazy = proc {$ N F EXU1} [local ["A","As","PTU1"] [PTU1 = '#'(1:A 2:As),"F" "PTU1",local ["EXU2"] [local ["EXU3","EXU4"] [EXU3 = N,EXU4 = 0,"Eq" "EXU3" "EXU4" "EXU2"],if EXU2 then [EXU1 = nil()] else [local ["EXU3","EXU4"] [EXU3 = A,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = N,EXU8 = 1,"IntMinus" "EXU7" "EXU8" "EXU5"],EXU6 = As,"TakeLazy" "EXU5" "EXU6" "EXU4"],EXU1 = '|'(1:EXU3 2:EXU4)]]]]],Ham = proc {$ EXU1} [EXU1 = proc {$ EXU2} [local ["F"] ["Ham" "F",local ["EXU3","EXU4"] [EXU3 = 1,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = 2,EXU8 = F,"Times" "EXU7" "EXU8" "EXU5"],local ["EXU7","EXU8"] [local ["EXU9","EXU10"] [EXU9 = 3,EXU10 = F,"Times" "EXU9" "EXU10" "EXU7"],local ["EXU9","EXU10"] [EXU9 = 5,EXU10 = F,"Times" "EXU9" "EXU10" "EXU8"],"Merge" "EXU7" "EXU8" "EXU6"],"Merge" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],local ["EXU1","EXU2"] [EXU1 = 16,"Ham" "EXU2","TakeLazy" "EXU1" "EXU2" "O"],skip/BO]]